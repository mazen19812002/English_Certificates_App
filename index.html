<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificates Generator - Dr. Mazen Badawy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script> <!-- Library for Excel -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&family=Tajawal:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            background-color: #e0f7fa;
            font-family: 'Cairo', sans-serif;
        }

        /* Certificate Design */
        .certificate-card {
            background-color: white;
            
            /* CSS Pattern Background (Replaces heavy image) */
            background-image: 
                radial-gradient(#1e40af 0.5px, transparent 0.5px), 
                radial-gradient(#1e40af 0.5px, #ffffff 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            
            /* Outer Border */
            border: 8px solid #1e40af; 
            
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            page-break-inside: avoid;
            min-height: 800px;
        }

        /* Inner Golden Frame using CSS pseudo-element */
        .certificate-card::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 4px double #fbbf24; /* Golden Double Border */
            pointer-events: none; /* Allows clicking through */
            z-index: 0;
        }

        /* Decorative Corners */
        .corner-decoration {
            position: absolute;
            width: 100px;
            height: 100px;
            z-index: 1;
            opacity: 0.8;
        }

        .corner-top-right {
            top: 10px;
            right: 10px;
            border-top: 4px solid #1e40af;
            border-right: 4px solid #1e40af;
        }
        
        .corner-top-right::after {
            content: 'â–';
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 24px;
            color: #fbbf24;
        }

        .corner-bottom-left {
            bottom: 10px;
            left: 10px;
            border-bottom: 4px solid #1e40af;
            border-left: 4px solid #1e40af;
        }

        .corner-bottom-left::after {
            content: 'â–';
            position: absolute;
            bottom: 5px;
            left: 5px;
            font-size: 24px;
            color: #fbbf24;
        }
        
        h1, h2, h3 { font-weight: 600; }

        .student-name {
            font-family: 'Tajawal', sans-serif;
            color: #1e3a8a;
            text-shadow: 1px 1px 0px #e2e8f0;
        }

        /* Photo Area */
        .photo-upload-area {
            width: 150px;
            height: 190px;
            border: 2px dashed #cbd5e1; 
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: border-color 0.3s;
            overflow: hidden;
            position: relative;
            z-index: 2; /* Ensure it's above the frame */
        }
        .photo-upload-area:hover { border-color: #3b82f6; }
        
        .photo-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block; 
        }

        .photo-placeholder {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #f8fafc;
            z-index: 1;
        }

        /* Print Styles */
        @media print {
            body { background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .no-print { display: none !important; }
            .certificate-card {
                break-inside: avoid;
                margin-bottom: 20px;
                box-shadow: none;
                page-break-after: always;
                height: 98vh;
                min-height: 98vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                
                /* Ensure background patterns print */
                background-color: white !important;
                background-image: 
                    radial-gradient(#1e40af 0.5px, transparent 0.5px), 
                    radial-gradient(#1e40af 0.5px, #ffffff 0.5px) !important;
                border: 8px solid #1e40af !important;
            }
            .certificate-card::before {
                border: 4px double #fbbf24 !important;
            }
            input[type="file"] { display: none; }
            .photo-upload-area { border: 2px solid #ddd; }
            .main-footer { display: none; }
            .cert-footer-text {
                display: block !important;
                position: absolute;
                bottom: 10px;
                width: 100%;
                text-align: center;
                font-size: 10px;
                color: #555;
            }
        }

        .btn-green { background-color: #16a34a; color: white; }
        .btn-green:hover { background-color: #15803d; }
        .btn-blue { background-color: #2563eb; color: white; }
        .btn-blue:hover { background-color: #1d4ed8; }
        .cert-footer-text { display: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header / Controls -->
    <header class="bg-white shadow-md p-4 mb-6 no-print sticky top-0 z-50">
        <div class="container mx-auto">
            <!-- Top Bar: Title & Actions -->
            <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-4">
                <h1 class="text-2xl text-blue-800 font-bold">
                    <i class="fas fa-certificate text-yellow-500 ml-2"></i>
                    Ù†Ø¸Ø§Ù… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª
                </h1>
                
                <div class="flex gap-2">
                    <!-- Data Status Indicator -->
                    <div id="dataStatus" class="flex items-center text-sm font-bold text-gray-500 px-3 bg-gray-100 rounded-lg">
                        <i class="fas fa-circle-notch fa-spin mr-2"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
                    </div>

                    <button onclick="window.print()" class="btn-green px-6 py-2 rounded-lg shadow font-bold flex items-center gap-2">
                        <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø© (Ctrl+P)
                    </button>
                </div>
            </div>

            <!-- Selection Area -->
            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 shadow-sm">
                <div class="flex justify-between items-center mb-2">
                    <label for="studentSelect" class="block text-blue-800 font-bold">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©:</label>
                    <span id="studentCount" class="text-sm text-gray-600 bg-white px-2 py-1 rounded border">Ø§Ù„Ø¹Ø¯Ø¯: -- Ø·Ø§Ù„Ø¨</span>
                </div>
                <div class="relative">
                    <select id="studentSelect" onchange="handleStudentChange()" class="w-full p-3 border-2 border-blue-300 rounded-lg text-lg focus:outline-none focus:border-blue-600 appearance-none bg-white">
                        <option value="" disabled selected>-- Ø§Ø®ØªØ± Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© --</option>
                        <option value="ALL" class="font-bold text-green-700">--- Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ (Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©) ---</option>
                        <!-- Options will be populated by JS -->
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center px-2 text-gray-700">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                <p class="text-xs text-gray-500 mt-2">
                    * ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ù…Ù„Ù <b>Book1.xlsx</b> Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø³Ø§Ø±.
                </p>
            </div>
        </div>
    </header>

    <!-- Certificates Container -->
    <main id="certificates-container" class="flex-grow container mx-auto p-4">
        <div class="text-center text-gray-500 mt-10 text-xl font-bold">
            ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰
        </div>
    </main>

    <!-- Fixed Footer -->
    <footer class="bg-gray-800 text-white p-4 mt-auto text-center border-t-4 border-green-500 main-footer">
        <p class="font-bold text-lg">
            All rights are reserved to Dr. Mazen Badawy â€“ Doctorate of English Teaching & Testing
        </p>
    </footer>

    <script>
        // Initial Data (Default / Fallback)
        let studentsData = [
            { id: 1, name: "Ù…Ø«Ø§Ù„: Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨", info: "ÙØµÙ„ 1-1" }
        ];

        // --- INIT ---
        window.onload = function() {
            populateDropdown();
            loadExcelData(); // Auto load on start
        };

        // --- EXCEL HANDLING ---
        async function loadExcelData() {
            const statusDiv = document.getElementById('dataStatus');
            try {
                // Try to fetch Book1.xlsx
                const response = await fetch('Book1.xlsx');
                
                if (!response.ok) {
                    throw new Error("File not found");
                }

                const arrayBuffer = await response.arrayBuffer();
                const data = new Uint8Array(arrayBuffer);
                const workbook = XLSX.read(data, {type: 'array'});
                
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                // Convert sheet to JSON array of arrays (header:1 gives raw rows)
                const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});

                // Process Data
                // Assuming Structure: Col A (Index 0) = ID/ImageNum, Col B (Index 1) = Name, Col C (Index 2) = Info
                const newStudents = [];
                
                jsonData.forEach((row, index) => {
                    if (row.length >= 2) { 
                            const valA = row[0] ? row[0].toString().trim() : "";
                            // Skip potential header
                            if (valA === "ID" || valA === "Ù…" || valA === "Ø§Ù„Ø±Ù‚Ù…") return; 

                            const id = row[0]; 
                            const name = row[1];
                            const info = row[2] || "Ø¹Ø§Ù…"; 

                            if (name) {
                                newStudents.push({ id: id, name: name, info: info });
                            }
                    }
                });

                if (newStudents.length > 0) {
                    studentsData = newStudents;
                    populateDropdown();
                    statusDiv.innerHTML = '<i class="fas fa-check-circle text-green-500 mr-2"></i> ØªÙ… ØªØ­Ù…ÙŠÙ„ Book1.xlsx';
                    statusDiv.className = "flex items-center text-sm font-bold text-green-700 px-3 bg-green-50 rounded-lg border border-green-200";
                } else {
                    statusDiv.innerHTML = '<i class="fas fa-exclamation-circle text-yellow-500 mr-2"></i> Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº';
                }

            } catch (err) {
                console.error("Auto load failed:", err);
                // Try CSV fallback if XLSX fails? Or just show error/default
                // For GitHub pages, ensure Book1.xlsx is committed
                statusDiv.innerHTML = '<i class="fas fa-info-circle text-blue-500 mr-2"></i> Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©';
                
                // Populate with the initial list provided in conversation if file fails
                studentsData = [
                    { id: 1, name: "Ú©Ø±Ù… Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ù…Ø­Ù…Ø¯ Ø±Ø²Ù‚ Ø³Ø¹Ø¯ Ø¬Ù†ÙˆØ±Ù‡", info: "ÙØµÙ„ 1-2" },
                    { id: 2, name: "Ù…Ø­Ù…Ø¯ Ø§Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„ÙØªØ§Ø­ Ù…Ø­Ù…Ø¯ ÙˆØ§ÙÙŠ", info: "ÙØµÙ„ 1-2" },
                    { id: 3, name: "Ø±Ù‡Ù Ø±Ø¶Ø§ Ø¬ÙˆÙ‡ÙŠØ± Ù…Ø­Ù…Ø¯ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ù…Ø±Ø³ÙŠ", info: "ÙØµÙ„ 1-2" },
                    { id: 4, name: "Ø±Ù‡Ù Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø³ÙŠØ¯ Ù…Ø­Ù…Ø¯", info: "ÙØµÙ„ 1-2" },
                    { id: 5, name: "Ø±ÙˆØ§Ù† Ù…Ø­Ù…Ø¯ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ø¬ÙŠØ¯", info: "ÙØµÙ„ 1-2" },
                    { id: 6, name: "Ø±ÙˆØ¯ÙŠÙ†Ø§ Ø±Ø¶Ø§ Ù…Ø­Ù…ÙˆØ¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ø¨Ùˆ Ø´Ø¹ÙŠØ´Ø¹", info: "ÙØµÙ„ 1-2" },
                    { id: 7, name: "Ø±ÙˆØ¯ÙŠÙ†Ø§ Ù…Ø¬Ø¯ÙŠ Ø§Ù„Ø³ÙŠØ¯ Ø¨Ø¯ÙŠØ± Ø¹Ù„ÙŠ Ø¬Ø§Ø¯ Ø§Ù„Ø­Ù‚", info: "ÙØµÙ„ 1-2" },
                    { id: 8, name: "Ø±ÙŠÙ…Ø§Ø³ Ø£Ø­Ù…Ø¯ Ø­Ø§Ù…Ø¯ Ø­Ø´ÙŠØ´", info: "ÙØµÙ„ 1-2" },
                    { id: 9, name: "Ø±ÙŠÙ…Ø§Ø³ Ø­Ù…Ø§Ø¯Ù‡ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ù…Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¬Ù…Ø¹Ù‡", info: "ÙØµÙ„ 1-2" },
                    { id: 10, name: "Ø±ÙŠÙ…Ø§Ø³ Ø¹Ø§Ù…Ø± Ø¹Ø¨Ø¯ Ø§Ù„Ù†Ø¨ÙŠ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø¤Ù Ø­Ø³Ù†", info: "ÙØµÙ„ 1-2" },
                    { id: 11, name: "Ø±ÙŠÙ…Ø§Ø³ Ø¹Ù„ÙŠ Ø§Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ø¬Ù…Ø§ÙˆÙŠ", info: "ÙØµÙ„ 1-2" },
                    { id: 12, name: "Ù‡Ø§Ø¬Ø± ØµØ§Ù„Ø­ Ø°ÙƒÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", info: "ÙØµÙ„ 1-2" },
                    { id: 13, name: "Ù…ÙŠØ±Ù†Ø§ Ø¹Ø¨Ø¯ Ø§Ù„Ù‚Ø§Ø¯Ø± Ù…Ø­ÙŠ Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ø´Ù†Ø§ÙˆÙŠ", info: "ÙØµÙ„ 1-3" },
                    { id: 14, name: "Ù†ÙˆØ±Ø§Ù† Ø§ÙŠÙ…Ù† Ù…Ù…Ø¯ÙˆØ­ Ù…ÙˆØ³ÙŠ", info: "ÙØµÙ„ 1-3" }
                ];
                populateDropdown();
            }
        }

        function populateDropdown() {
            const select = document.getElementById('studentSelect');
            select.innerHTML = '';
            
            // Default option
            const defaultOption = document.createElement('option');
            defaultOption.value = "";
            defaultOption.disabled = true;
            defaultOption.selected = true;
            defaultOption.textContent = "-- Ø§Ø®ØªØ± Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© --";
            select.appendChild(defaultOption);

            // All option
            const allOption = document.createElement('option');
            allOption.value = "ALL";
            allOption.className = "font-bold text-green-700";
            allOption.textContent = "--- Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ (Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©) ---";
            select.appendChild(allOption);

            // Student options
            studentsData.forEach(student => {
                const option = document.createElement('option');
                option.value = student.id; // Use ID as value
                option.textContent = `${student.id} - ${student.name}`;
                select.appendChild(option);
            });

            // Update count
            document.getElementById('studentCount').textContent = `Ø§Ù„Ø¹Ø¯Ø¯: ${studentsData.length} Ø·Ø§Ù„Ø¨`;
        }

        // --- RENDER LOGIC ---
        function handleStudentChange() {
            const select = document.getElementById('studentSelect');
            const container = document.getElementById('certificates-container');
            const selectedValue = select.value;

            container.innerHTML = ''; 

            if (selectedValue === "ALL") {
                container.className = "flex-grow container mx-auto p-4 grid grid-cols-1 md:grid-cols-2 gap-8";
                studentsData.forEach(student => {
                    container.innerHTML += createCertificateHTML(student);
                });
            } else {
                container.className = "flex-grow container mx-auto p-4 flex justify-center";
                // Note: ID comparison should be loose (==) because value is string, data.id might be number
                const student = studentsData.find(s => s.id == selectedValue);
                if (student) {
                    container.innerHTML = `<div class="w-full max-w-4xl">${createCertificateHTML(student)}</div>`;
                }
            }
        }

        // HTML Generator
        function createCertificateHTML(student) {
            return `
            <div class="certificate-card pt-10 px-24 pb-48 rounded-lg text-center relative flex flex-col items-center justify-between">
                <!-- Corner Decorations (CSS Only) -->
                <div class="corner-decoration corner-top-right"></div>
                <div class="corner-decoration corner-bottom-left"></div>

                <!-- Header -->
                <div class="w-full flex justify-between items-start mb-2 relative z-10">
                    <div class="text-right" style="margin-top: 1cm;">
                        <h3 class="text-lg font-bold text-gray-700 leading-tight">Ù…Ø­Ø§ÙØ¸Ø© ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®</h3>
                        <h3 class="text-lg font-bold text-gray-700 leading-tight">Ø¥Ø¯Ø§Ø±Ø© Ø´Ø±Ù‚ ÙƒÙØ± Ø§Ù„Ø´ÙŠØ® Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h3>
                        <h3 class="text-lg font-bold text-gray-700 leading-tight">Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø´Ù‡ÙŠØ¯ Ù†Ø¬ÙŠØ¨ Ù…Ø­ÙŠ Ø§Ù„Ø´Ù†Ø§ÙˆÙŠ</h3>
                        <h3 class="text-lg font-bold text-gray-700 leading-tight">Ù„Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø¨Ø¯Ù‚Ù…ÙŠØ±Ø©</h3>
                    </div>
                    
                    <!-- Photo Area (Moved 1cm left (relative to previous 0.5cm) -> -0.5cm left) -->
                    <!-- Using student.id for filename (e.g. 1.png) as requested -->
                    <div class="photo-upload-area rounded-md shadow-inner" 
                         style="transform: translate(-0.5cm, 0.5cm);"
                         onclick="document.getElementById('file-${student.id}').click()">
                        
                        <!-- Fallback Icon -->
                        <div class="photo-placeholder" id="placeholder-${student.id}">
                            <i class="fas fa-camera text-2xl mb-1 text-gray-400"></i>
                            <span class="text-xs block text-gray-400">ØµÙˆØ±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨</span>
                        </div>

                        <!-- Main Image -->
                        <img 
                            src="${student.id}.png" 
                            class="photo-preview rounded-md relative z-10" 
                            alt="Student Photo"
                            onerror="this.style.display='none'; document.getElementById('placeholder-${student.id}').style.zIndex='20';"
                            onload="document.getElementById('placeholder-${student.id}').style.display='none';"
                            id="img-${student.id}"
                        >
                        
                        <input type="file" id="file-${student.id}" accept="image/*" class="hidden" onchange="manualImageUpload(this, '${student.id}')">
                    </div>
                </div>

                <!-- Title -->
                <div class="mb-4 mt-2 relative z-10">
                    <h1 class="text-5xl text-green-700 font-bold mb-1 font-cairo" style="font-family: 'Cairo', sans-serif;">Ø´Ù‡Ø§Ø¯Ø© ØªÙ‚Ø¯ÙŠØ± ÙˆØªÙÙˆÙ‚</h1>
                    <div class="h-1.5 w-32 bg-yellow-500 mx-auto rounded"></div>
                    <h2 class="text-xl text-blue-900 mt-1 font-thin tracking-wide">Certificate of Appreciation</h2>
                </div>

                <!-- Content -->
                <div class="mb-4 w-full relative z-10">
                    <p class="text-2xl text-gray-700 mb-2 font-semibold">ØªØªÙ‚Ø¯Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆØ£Ø³Ø±Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø®Ø§Ù„Øµ Ø§Ù„Ø´ÙƒØ± ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± Ù„Ù„Ø·Ø§Ù„Ø¨/Ø©:</p>
                    
                    <div class="py-2 px-6 my-3 bg-blue-50/80 border-y-2 border-blue-200 mx-auto w-full backdrop-blur-sm">
                        <h2 class="text-4xl font-bold text-blue-900 student-name leading-tight">${student.name}</h2>
                    </div>

                    <p class="text-lg text-gray-700 leading-relaxed">
                        ÙˆØ°Ù„Ùƒ Ù„ØªÙÙˆÙ‚Ù‡/Ø§ Ø§Ù„Ù…Ù„Ø­ÙˆØ¸ ÙˆØ­ØµÙˆÙ„Ù‡/Ø§ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª ÙÙŠ Ù…Ø§Ø¯Ø©
                    </p>
                    <div class="text-green-700 font-bold text-3xl mt-2 mb-2">
                        Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
                    </div>
                    
                    <div class="mt-3 flex justify-center items-center gap-2 text-lg text-gray-600 font-semibold bg-gray-50/90 inline-block px-6 py-2 rounded-full border border-gray-200 shadow-sm">
                         <span>Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</span>
                         <span class="text-yellow-600 mx-1">â˜…</span>
                         <span class="text-blue-800">${student.info}</span>
                         <span class="text-yellow-600 mx-1">â˜…</span>
                         <span>Ø§Ù„ØªØ±Ù… Ø§Ù„Ø£ÙˆÙ„ 2025-2026</span>
                    </div>
                </div>

                <!-- Signatures -->
                <div class="w-full flex justify-around items-end mt-4 pt-4 border-t border-gray-200 relative z-10" style="transform: translateX(-20px);">
                    <div class="text-center">
                        <p class="text-lg text-gray-500 font-bold mb-1">Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</p>
                        <div class="h-8 flex items-center justify-center">
                            <p class="font-bold text-blue-900 text-xl" style="font-family: 'Tajawal', sans-serif;">Ø¯. Ù…Ø§Ø²Ù† ÙÙˆØ²ÙŠ Ø¨Ø¯ÙˆÙŠ</p>
                        </div>
                    </div>
                    <div class="text-center">
                         <div class="w-20 h-20 mb-1 mx-auto relative flex items-center justify-center opacity-70">
                            <!-- Education Stamp Emoji -->
                            <div class="absolute inset-0 border-4 border-blue-200 rounded-full transform -rotate-12"></div>
                            <div class="text-4xl transform -rotate-12 filter drop-shadow-sm text-blue-800">
                                ğŸ“
                            </div>
                        </div>
                    </div>
                    <div class="text-center">
                        <p class="text-lg text-gray-500 font-bold mb-1">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p>
                        <div class="h-8 flex items-center justify-center">
                           <p class="font-bold text-blue-900 text-xl" style="font-family: 'Tajawal', sans-serif;">Ø§. Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ù†Ø¹Ù… Ù‡Ù„Ø§Ù„</p>
                        </div>
                    </div>
                </div>

                <!-- Print Only Footer -->
                <div class="cert-footer-text">
                    All rights are reserved to Dr. Mazen Badawy â€“ Doctorate of English Teaching & Testing
                </div>
            </div>
            `;
        }

        // Manual Image Upload Handler
        function manualImageUpload(input, id) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const ph = document.getElementById(`placeholder-${id}`);
                    if(ph) ph.style.display = 'none';
                    
                    const img = document.getElementById(`img-${id}`);
                    img.style.display = 'block';
                    img.src = e.target.result;
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
    </script>
</body>
</html>
